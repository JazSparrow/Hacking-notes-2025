# Mini RSA

### Description

What happens if you have a small exponent? There is a twist though, we padded the plaintext so that (M ** e) is just barely larger than N. Let's decrypt this: [ciphertext](https://mercury.picoctf.net/static/2d884b04dbb44896dda1276774b09216/ciphertext)

### Hints

* RSA [tutorial](https://en.wikipedia.org/wiki/RSA_\(cryptosystem\))
* How could having too small of an `e` affect the security of this key?
* Make sure you don't lose precision, the numbers are pretty big (besides the `e` value)
* You shouldn't have to make _too_ many guesses
* `pico` is in the flag, but not at the beginning

## Solución

Primero descargamos el archivo que nos aparece en nuestra descripción con el wget.
Enseguida aplicamos un `cat` al archivo y nos mostrara los datos que necesitaremos para el código en python:

* `cat ciphertext`

Instalamos el gmpy2 con el siguiente comando ya que lo necesitaremos para el código que se realizará:
* `sudo apt install python3-gmpy2`

Y una vez finalizado el código lo ejecutamos con python3 enseguida del nombre del archivo de la siguiente manera:
* `python3 exp.py`

Y con esto nos mostrara nuestra respectiva flag.

## Terminal de ejemplo

```
jazmin@DESKTOP-1CBQJ6D:~$ cd FSI
jazmin@DESKTOP-1CBQJ6D:~/FSI$ mkdir minirsa
jazmin@DESKTOP-1CBQJ6D:~/FSI$ cd minirsa
jazmin@DESKTOP-1CBQJ6D:~/FSI/minirsa$ wget https://mercury.picoctf.net/static/2d884b04dbb44896dda1276774b09216/ciphertext
--2025-05-21 12:08:28--  https://mercury.picoctf.net/static/2d884b04dbb44896dda1276774b09216/ciphertext
Resolving mercury.picoctf.net (mercury.picoctf.net)... 18.189.209.142
Connecting to mercury.picoctf.net (mercury.picoctf.net)|18.189.209.142|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2039 (2.0K) [application/octet-stream]
Saving to: ‘ciphertext’

ciphertext                    100%[=================================================>]   1.99K  --.-KB/s    in 0s

2025-05-21 12:08:28 (144 MB/s) - ‘ciphertext’ saved [2039/2039]

jazmin@DESKTOP-1CBQJ6D:~/FSI/minirsa$ cat ciphertext
N: 1615765684321463054078226051959887884233678317734892901740763321135213636796075462401950274602405095138589898087428337758445013281488966866073355710771864671726991918706558071231266976427184673800225254531695928541272546385146495736420261815693810544589811104967829354461491178200126099661909654163542661541699404839644035177445092988952614918424317082380174383819025585076206641993479326576180793544321194357018916215113009742654408597083724508169216182008449693917227497813165444372201517541788989925461711067825681947947471001390843774746442699739386923285801022685451221261010798837646928092277556198145662924691803032880040492762442561497760689933601781401617086600593482127465655390841361154025890679757514060456103104199255917164678161972735858939464790960448345988941481499050248673128656508055285037090026439683847266536283160142071643015434813473463469733112182328678706702116054036618277506997666534567846763938692335069955755244438415377933440029498378955355877502743215305768814857864433151287
e: 3

ciphertext (c): 1220012318588871886132524757898884422174534558055593713309088304910273991073554732659977133980685370899257850121970812405700793710546674062154237544840177616746805668666317481140872605653768484867292138139949076102907399831998827567645230986345455915692863094364797526497302082734955903755050638155202890599808154521995312832362835648711819155169679435239286935784452613518014043549023137530689967601174246864606495200453313556091158637122956278811935858649498244722557014003601909465057421728834883411992999408157828996722087360414577252630186866387785481057649036414986099181831292644783916873710123009473008639825720434282893177856511819939659625989092206115515005188455003918918879483234969164887705505900695379846159901322053253156096586139847768297521166448931631916220211254417971683366167719596219422776768895460908015773369743067718890024592505393221967098308653507944367482969331133726958321767736855857529350486000867434567743580745186277999637935034821461543527421831665171525793988229518569050
jazmin@DESKTOP-1CBQJ6D:~/FSI/minirsa$
jazmin@DESKTOP-1CBQJ6D:~/FSI/minirsa$ sudo apt install python3-gmpy2
[sudo] password for jazmin:
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following additional packages will be installed:
  python-gmpy2-common
Suggested packages:
  python-gmpy2-doc
The following NEW packages will be installed:
  python-gmpy2-common python3-gmpy2
0 upgraded, 2 newly installed, 0 to remove and 25 not upgraded.
Need to get 182 kB of archives.
After this operation, 689 kB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://archive.ubuntu.com/ubuntu focal/universe amd64 python-gmpy2-common all 2.1.0~b3-3ubuntu2 [26.6 kB]
Get:2 http://archive.ubuntu.com/ubuntu focal/universe amd64 python3-gmpy2 amd64 2.1.0~b3-3ubuntu2 [155 kB]
Fetched 182 kB in 1s (214 kB/s)
Selecting previously unselected package python-gmpy2-common.
(Reading database ... 89748 files and directories currently installed.)
Preparing to unpack .../python-gmpy2-common_2.1.0~b3-3ubuntu2_all.deb ...
Unpacking python-gmpy2-common (2.1.0~b3-3ubuntu2) ...
Selecting previously unselected package python3-gmpy2.
Preparing to unpack .../python3-gmpy2_2.1.0~b3-3ubuntu2_amd64.deb ...
Unpacking python3-gmpy2 (2.1.0~b3-3ubuntu2) ...
Setting up python-gmpy2-common (2.1.0~b3-3ubuntu2) ...
Setting up python3-gmpy2 (2.1.0~b3-3ubuntu2) ...
Processing triggers for man-db (2.9.1-1) ...
jazmin@DESKTOP-1CBQJ6D:~/FSI/minirsa$ python3 exp.py
[+] Found exact cube root with k=3533
Decrypted plaintext (as integer): 1787330808968142828287809319332701517353332911736848279839502759158602467824780424488141955644417387373185756944952906538004355347478978500948630620749868180414755933760446136287315896825929319145984883756667607031853695069891380871892213007874933611243319812691520078269033745367443951846845107464675742664639073700700745451895920079741
Decrypted plaintext (ASCII): b'                                                                                                        picoCTF{e_sh0u1d_b3_lArg3r_a166c1e3}'
jazmin@DESKTOP-1CBQJ6D:~/FSI/minirsa$
```

Después en otra terminal ingresamos el siguiente comando para realizar el programa en python:

`nano exp.py`

Y escribimos el siguiente código con los datos que nos proporcionaron anteriormente.
## Programa exp.py realizado en GNU nano 4.8

```
from gmpy2 import iroot

N = 1615765684321463054078226051959887884233678317734892901740763321135213636796075462401950274602405095138589898087428337758445013281488966866073355710771864671726991918706558071231266976427184673800225254531695928541272546385146495736420261815693810544589811104967829354461491178200126099661909654163542661541699404839644035177445092988952614918424317082380174383819025585076206641993479326576180793544321194357018916215113009742654408597083724508169216182008449693917227497813165444372201517541788989925461711067825681947947471001390843774746442699739386923285801022685451221261010798837646928092277556198145662924691803032880040492762442561497760689933601781401617086600593482127465655390841361154025890679757514060456103104199255917164678161972735858939464790960448345988941481499050248673128656508055285037090026439683847266536283160142071643015434813473463469733112182328678706702116054036618277506997666534567846763938692335069955755244438415377933440029498378955355877502743215305768814857864433151287
e = 3
C = 1220012318588871886132524757898884422174534558055593713309088304910273991073554732659977133980685370899257850121970812405700793710546674062154237544840177616746805668666317481140872605653768484867292138139949076102907399831998827567645230986345455915692863094364797526497302082734955903755050638155202890599808154521995312832362835648711819155169679435239286935784452613518014043549023137530689967601174246864606495200453313556091158637122956278811935858649498244722557014003601909465057421728834883411992999408157828996722087360414577252630186866387785481057649036414986099181831292644783916873710123009473008639825720434282893177856511819939659625989092206115515005188455003918918879483234969164887705505900695379846159901322053253156096586139847768297521166448931631916220211254417971683366167719596219422776768895460908015773369743067718890024592505393221967098308653507944367482969331133726958321767736855857529350486000867434567743580745186277999637935034821461543527421831665171525793988229518569050

for k in range(1, 100000):
     candidate = C + K * n
     m_root, exact = iroot(candidate, e)
     if exact:
         print(f'[+] Encontre raiz cubica exactak={k})
         print('Entero desencriptado:', m_root)
         print('flag(ASCII):', bytes,fromhex(hex(m_root)[2:]))
         break
```

### Respuesta: picoCTF{e_sh0u1d_b3_lArg3r_a166c1e3}